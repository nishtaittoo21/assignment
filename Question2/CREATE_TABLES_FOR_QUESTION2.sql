/*
    AUTHOR  : NISHTABYE ITTOO
    PURPOSE : To create all necessary tables for Question 2
 */

CREATE TABLE SUPPLIER_DATA(
    SUPPLIER_ID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    SUPPLIER_NAME VARCHAR2(100) NOT NULL,
    SUPP_CONTACT_NAME VARCHAR2(100) NOT NULL,
    SUPP_ADDRESS VARCHAR2(200) NOT NULL,
    SUPP_MOBILE_NUMBER VARCHAR2(15),
    SUPP_PHONE_NUMBER VARCHAR2(15),
    SUPP_EMAIL VARCHAR2(50) NOT NULL CONSTRAINT chk_supp_email_format CHECK (SUPP_EMAIL LIKE '%@%.%')
);


CREATE TABLE ORDER_SUMMARY(
  ORDER_REF VARCHAR2(5) PRIMARY KEY,
  ORDER_DATE DATE NOT NULL,
  SUPPLIER_ID INTEGER NOT NULL, CONSTRAINT fk_supplier FOREIGN KEY (SUPPLIER_ID) REFERENCES SUPPLIER_DATA(SUPPLIER_ID),
  ORDER_TOTAL_AMOUNT NUMBER(20) NOT NULL,
  ORDER_DESCRIPTION VARCHAR2(100) NOT NULL,
  ORDER_STATUS VARCHAR2(10) NOT NULL CONSTRAINT chk_order_staus CHECK (ORDER_STATUS IN ('Open', 'Closed'))
);

CREATE TABLE ORDER_LINE_DETAILS(
    ORDER_LINE_ID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ORDER_REF VARCHAR2(7) NOT NULL,
    ORDER_PARENT_REF VARCHAR2(5) NOT NULL, CONSTRAINT fk_order_ref FOREIGN KEY (ORDER_PARENT_REF) REFERENCES ORDER_SUMMARY(ORDER_REF),
    ORDER_DESCRIPTION VARCHAR2(100) NOT NULL,
    ORDER_STATUS VARCHAR2(10)  NOT NULL CONSTRAINT chk_order_line_staus CHECK (ORDER_STATUS IN ('Received', 'Cancelled')),
    ORDER_LINE_AMOUNT NUMBER(20) NOT NULL
);


CREATE TABLE INVOICE_PAYMENT(
    PAYMENT_ID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    INVOICE_REFERENCE VARCHAR2(15),
    ORDER_LINE_ID NUMBER NOT NULL, CONSTRAINT fk_order_line_reference FOREIGN KEY (ORDER_LINE_ID) REFERENCES ORDER_LINE_DETAILS(ORDER_LINE_ID),
    INVOICE_DATE DATE NOT NULL,
    INVOICE_STATUS VARCHAR2(10) NOT NULL CONSTRAINT chk_invoice_staus CHECK (INVOICE_STATUS IN ('Paid', 'Pending')),
    INVOICE_HOLD_REASON VARCHAR2(100),
    INVOICE_AMOUNT NUMBER(20) NOT NULL,
    INVOICE_DESCRIPTION VARCHAR2(50)
);



